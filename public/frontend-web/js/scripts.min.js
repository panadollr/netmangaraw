function HideMenuToolbar() {
    $("#toolbar").fadeOut(), $("#toolbarbut").fadeIn("slow");
}
function ShowMenuToolbar() {
    $("#toolbar").fadeIn(), $("#toolbarbut").fadeOut("slow");
}
function Get_Cookie(e) {
    var o = document.cookie.split(";"),
        a = "",
        n = "",
        r = !1,
        s = "";
    for (s = 0; s < o.length; s++) {
        if ((a = o[s].split("="))[0].replace(/^\s+|\s+$/g, "") == e)
            return (
                (r = !0),
                a.length > 1 && (n = unescape(a[1].replace(/^\s+|\s+$/g, ""))),
                n
            );
        a = null;
    }
    if (!r) return null;
}
function Set_Cookie(e, o, a, n, r, s) {
    var l = new Date();
    l.setTime(l.getTime()), a && (a = 1e3 * a * 86400);
    var c = new Date(l.getTime() + a);
    document.cookie =
        e +
        "=" +
        escape(o) +
        (a ? ";expires=" + c.toGMTString() : "") +
        (n ? ";path=" + n : "") +
        (r ? ";domain=" + r : "") +
        (s ? ";secure" : "");
}
function Delete_Cookie(e, o, a) {
    Get_Cookie(e) &&
        (document.cookie =
            e +
            "=" +
            (o ? ";path=" + o : "") +
            (a ? ";domain=" + a : "") +
            ";expires=Thu, 01-Jan-1970 00:00:01 GMT");
}
function SetReferrerPolicy(e) {
    var o = document.querySelector('meta[name="referrer"]');
    if (null != o)
        1 == e
            ? o.setAttribute("content", "no-referrer")
            : o.setAttribute("content", "no-referrer-when-downgrade");
    else {
        var a = document.createElement("meta");
        (a.name = "referrer"),
            (a.content = 1 == e ? "no-referrer" : "no-referrer-when-downgrade"),
            document.getElementsByTagName("head")[0].appendChild(a);
    }
}
!(function () {
    "use strict";
    if ("object" == typeof window) {
        if (
            "IntersectionObserver" in window &&
            "IntersectionObserverEntry" in window &&
            "intersectionRatio" in window.IntersectionObserverEntry.prototype
        )
            "isIntersecting" in window.IntersectionObserverEntry.prototype ||
                Object.defineProperty(
                    window.IntersectionObserverEntry.prototype,
                    "isIntersecting",
                    {
                        get: function () {
                            return this.intersectionRatio > 0;
                        },
                    }
                );
        else {
            var e = window.document,
                o = [],
                a = null,
                n = null;
            (s.prototype.THROTTLE_TIMEOUT = 100),
                (s.prototype.POLL_INTERVAL = null),
                (s.prototype.USE_MUTATION_OBSERVER = !0),
                (s._setupCrossOriginUpdater = function () {
                    return (
                        a ||
                            (a = function (e, a) {
                                (n =
                                    e && a
                                        ? u(e, a)
                                        : {
                                              top: 0,
                                              bottom: 0,
                                              left: 0,
                                              right: 0,
                                              width: 0,
                                              height: 0,
                                          }),
                                    o.forEach(function (e) {
                                        e._checkForIntersections();
                                    });
                            }),
                        a
                    );
                }),
                (s._resetCrossOriginUpdater = function () {
                    (a = null), (n = null);
                }),
                (s.prototype.observe = function (e) {
                    if (
                        !this._observationTargets.some(function (o) {
                            return o.element == e;
                        })
                    ) {
                        if (!e || 1 != e.nodeType)
                            throw Error("target must be an Element");
                        this._registerInstance(),
                            this._observationTargets.push({
                                element: e,
                                entry: null,
                            }),
                            this._monitorIntersections(e.ownerDocument),
                            this._checkForIntersections();
                    }
                }),
                (s.prototype.unobserve = function (e) {
                    (this._observationTargets = this._observationTargets.filter(
                        function (o) {
                            return o.element != e;
                        }
                    )),
                        this._unmonitorIntersections(e.ownerDocument),
                        0 == this._observationTargets.length &&
                            this._unregisterInstance();
                }),
                (s.prototype.disconnect = function () {
                    (this._observationTargets = []),
                        this._unmonitorAllIntersections(),
                        this._unregisterInstance();
                }),
                (s.prototype.takeRecords = function () {
                    var e = this._queuedEntries.slice();
                    return (this._queuedEntries = []), e;
                }),
                (s.prototype._initThresholds = function (e) {
                    var o = e || [0];
                    return (
                        Array.isArray(o) || (o = [o]),
                        o.sort().filter(function (e, o, a) {
                            if (
                                "number" != typeof e ||
                                isNaN(e) ||
                                e < 0 ||
                                e > 1
                            )
                                throw Error(
                                    "threshold must be a number between 0 and 1 inclusively"
                                );
                            return e !== a[o - 1];
                        })
                    );
                }),
                (s.prototype._parseRootMargin = function (e) {
                    var o = (e || "0px").split(/\s+/).map(function (e) {
                        var o = /^(-?\d*\.?\d+)(px|%)$/.exec(e);
                        if (!o)
                            throw Error(
                                "rootMargin must be specified in pixels or percent"
                            );
                        return { value: parseFloat(o[1]), unit: o[2] };
                    });
                    return (
                        (o[1] = o[1] || o[0]),
                        (o[2] = o[2] || o[0]),
                        (o[3] = o[3] || o[1]),
                        o
                    );
                }),
                (s.prototype._monitorIntersections = function (o) {
                    var a = o.defaultView;
                    if (a && -1 == this._monitoringDocuments.indexOf(o)) {
                        var n = this._checkForIntersections,
                            r = null,
                            s = null;
                        if (
                            (this.POLL_INTERVAL
                                ? (r = a.setInterval(n, this.POLL_INTERVAL))
                                : (l(a, "resize", n, !0),
                                  l(o, "scroll", n, !0),
                                  this.USE_MUTATION_OBSERVER &&
                                      "MutationObserver" in a &&
                                      (s = new a.MutationObserver(n)).observe(
                                          o,
                                          {
                                              attributes: !0,
                                              childList: !0,
                                              characterData: !0,
                                              subtree: !0,
                                          }
                                      )),
                            this._monitoringDocuments.push(o),
                            this._monitoringUnsubscribes.push(function () {
                                var e = o.defaultView;
                                e &&
                                    (r && e.clearInterval(r),
                                    c(e, "resize", n, !0)),
                                    c(o, "scroll", n, !0),
                                    s && s.disconnect();
                            }),
                            o != ((this.root && this.root.ownerDocument) || e))
                        ) {
                            var d = m(o);
                            d && this._monitorIntersections(d.ownerDocument);
                        }
                    }
                }),
                (s.prototype._unmonitorIntersections = function (o) {
                    var a = this._monitoringDocuments.indexOf(o);
                    if (-1 != a) {
                        var n = (this.root && this.root.ownerDocument) || e;
                        if (
                            !this._observationTargets.some(function (e) {
                                var a = e.element.ownerDocument;
                                if (a == o) return !0;
                                for (; a && a != n; ) {
                                    var r = m(a);
                                    if ((a = r && r.ownerDocument) == o)
                                        return !0;
                                }
                                return !1;
                            })
                        ) {
                            var r = this._monitoringUnsubscribes[a];
                            if (
                                (this._monitoringDocuments.splice(a, 1),
                                this._monitoringUnsubscribes.splice(a, 1),
                                r(),
                                o != n)
                            ) {
                                var s = m(o);
                                s &&
                                    this._unmonitorIntersections(
                                        s.ownerDocument
                                    );
                            }
                        }
                    }
                }),
                (s.prototype._unmonitorAllIntersections = function () {
                    var e = this._monitoringUnsubscribes.slice(0);
                    (this._monitoringDocuments.length = 0),
                        (this._monitoringUnsubscribes.length = 0);
                    for (var o = 0; o < e.length; o++) e[o]();
                }),
                (s.prototype._checkForIntersections = function () {
                    if (this.root || !a || n) {
                        var e = this._rootIsInDom(),
                            o = e
                                ? this._getRootRect()
                                : {
                                      top: 0,
                                      bottom: 0,
                                      left: 0,
                                      right: 0,
                                      width: 0,
                                      height: 0,
                                  };
                        this._observationTargets.forEach(function (n) {
                            var s = n.element,
                                l = d(s),
                                c = this._rootContainsTarget(s),
                                p = n.entry,
                                u =
                                    e &&
                                    c &&
                                    this._computeTargetAndRootIntersection(
                                        s,
                                        l,
                                        o
                                    ),
                                h = (n.entry = new r({
                                    time:
                                        window.performance &&
                                        performance.now &&
                                        performance.now(),
                                    target: s,
                                    boundingClientRect: l,
                                    rootBounds: a && !this.root ? null : o,
                                    intersectionRect: u,
                                }));
                            p
                                ? e && c
                                    ? this._hasCrossedThreshold(p, h) &&
                                      this._queuedEntries.push(h)
                                    : p &&
                                      p.isIntersecting &&
                                      this._queuedEntries.push(h)
                                : this._queuedEntries.push(h);
                        }, this),
                            this._queuedEntries.length &&
                                this._callback(this.takeRecords(), this);
                    }
                }),
                (s.prototype._computeTargetAndRootIntersection = function (
                    o,
                    r,
                    s
                ) {
                    if ("none" != window.getComputedStyle(o).display) {
                        for (
                            var l, c, p, h, m, g, v, x, b = r, C = f(o), y = !1;
                            !y && C;

                        ) {
                            var T = null,
                                w =
                                    1 == C.nodeType
                                        ? window.getComputedStyle(C)
                                        : {};
                            if ("none" == w.display) return null;
                            if (C == this.root || 9 == C.nodeType) {
                                if (((y = !0), C == this.root || C == e))
                                    a && !this.root
                                        ? n && (0 != n.width || 0 != n.height)
                                            ? (T = n)
                                            : ((C = null),
                                              (T = null),
                                              (b = null))
                                        : (T = s);
                                else {
                                    var _ = f(C),
                                        S = _ && d(_),
                                        k =
                                            _ &&
                                            this._computeTargetAndRootIntersection(
                                                _,
                                                S,
                                                s
                                            );
                                    S && k
                                        ? ((C = _), (T = u(S, k)))
                                        : ((C = null), (b = null));
                                }
                            } else {
                                var I = C.ownerDocument;
                                C != I.body &&
                                    C != I.documentElement &&
                                    "visible" != w.overflow &&
                                    (T = d(C));
                            }
                            if (
                                (T &&
                                    ((l = T),
                                    (c = b),
                                    (p = Math.max(l.top, c.top)),
                                    (h = Math.min(l.bottom, c.bottom)),
                                    (m = Math.max(l.left, c.left)),
                                    (x = h - p),
                                    (b =
                                        ((v =
                                            (g = Math.min(l.right, c.right)) -
                                            m) >= 0 &&
                                            x >= 0 && {
                                                top: p,
                                                bottom: h,
                                                left: m,
                                                right: g,
                                                width: v,
                                                height: x,
                                            }) ||
                                        null)),
                                !b)
                            )
                                break;
                            C = C && f(C);
                        }
                        return b;
                    }
                }),
                (s.prototype._getRootRect = function () {
                    var o;
                    if (this.root) o = d(this.root);
                    else {
                        var a = e.documentElement,
                            n = e.body;
                        o = {
                            top: 0,
                            left: 0,
                            right: a.clientWidth || n.clientWidth,
                            width: a.clientWidth || n.clientWidth,
                            bottom: a.clientHeight || n.clientHeight,
                            height: a.clientHeight || n.clientHeight,
                        };
                    }
                    return this._expandRectByRootMargin(o);
                }),
                (s.prototype._expandRectByRootMargin = function (e) {
                    var o = this._rootMarginValues.map(function (o, a) {
                            return "px" == o.unit
                                ? o.value
                                : (o.value * (a % 2 ? e.width : e.height)) /
                                      100;
                        }),
                        a = {
                            top: e.top - o[0],
                            right: e.right + o[1],
                            bottom: e.bottom + o[2],
                            left: e.left - o[3],
                        };
                    return (
                        (a.width = a.right - a.left),
                        (a.height = a.bottom - a.top),
                        a
                    );
                }),
                (s.prototype._hasCrossedThreshold = function (e, o) {
                    var a =
                            e && e.isIntersecting
                                ? e.intersectionRatio || 0
                                : -1,
                        n = o.isIntersecting ? o.intersectionRatio || 0 : -1;
                    if (a !== n)
                        for (var r = 0; r < this.thresholds.length; r++) {
                            var s = this.thresholds[r];
                            if (s == a || s == n || s < a != s < n) return !0;
                        }
                }),
                (s.prototype._rootIsInDom = function () {
                    return !this.root || h(e, this.root);
                }),
                (s.prototype._rootContainsTarget = function (o) {
                    return (
                        h(this.root || e, o) &&
                        (!this.root ||
                            this.root.ownerDocument == o.ownerDocument)
                    );
                }),
                (s.prototype._registerInstance = function () {
                    0 > o.indexOf(this) && o.push(this);
                }),
                (s.prototype._unregisterInstance = function () {
                    var e = o.indexOf(this);
                    -1 != e && o.splice(e, 1);
                }),
                (window.IntersectionObserver = s),
                (window.IntersectionObserverEntry = r);
        }
    }
    function r(e) {
        (this.time = e.time),
            (this.target = e.target),
            (this.rootBounds = p(e.rootBounds)),
            (this.boundingClientRect = p(e.boundingClientRect)),
            (this.intersectionRect = p(
                e.intersectionRect || {
                    top: 0,
                    bottom: 0,
                    left: 0,
                    right: 0,
                    width: 0,
                    height: 0,
                }
            )),
            (this.isIntersecting = !!e.intersectionRect);
        var o = this.boundingClientRect,
            a = o.width * o.height,
            n = this.intersectionRect,
            r = n.width * n.height;
        this.intersectionRatio = a
            ? Number((r / a).toFixed(4))
            : this.isIntersecting
            ? 1
            : 0;
    }
    function s(e, o) {
        var a,
            n,
            r,
            s = o || {};
        if ("function" != typeof e) throw Error("callback must be a function");
        if (s.root && 1 != s.root.nodeType)
            throw Error("root must be an Element");
        (this._checkForIntersections =
            ((a = this._checkForIntersections.bind(this)),
            (n = this.THROTTLE_TIMEOUT),
            (r = null),
            function () {
                r ||
                    (r = setTimeout(function () {
                        a(), (r = null);
                    }, n));
            })),
            (this._callback = e),
            (this._observationTargets = []),
            (this._queuedEntries = []),
            (this._rootMarginValues = this._parseRootMargin(s.rootMargin)),
            (this.thresholds = this._initThresholds(s.threshold)),
            (this.root = s.root || null),
            (this.rootMargin = this._rootMarginValues
                .map(function (e) {
                    return e.value + e.unit;
                })
                .join(" ")),
            (this._monitoringDocuments = []),
            (this._monitoringUnsubscribes = []);
    }
    function l(e, o, a, n) {
        "function" == typeof e.addEventListener
            ? e.addEventListener(o, a, n || !1)
            : "function" == typeof e.attachEvent && e.attachEvent("on" + o, a);
    }
    function c(e, o, a, n) {
        "function" == typeof e.removeEventListener
            ? e.removeEventListener(o, a, n || !1)
            : "function" == typeof e.detatchEvent &&
              e.detatchEvent("on" + o, a);
    }
    function d(e) {
        var o;
        try {
            o = e.getBoundingClientRect();
        } catch (a) {}
        return o
            ? ((o.width && o.height) ||
                  (o = {
                      top: o.top,
                      right: o.right,
                      bottom: o.bottom,
                      left: o.left,
                      width: o.right - o.left,
                      height: o.bottom - o.top,
                  }),
              o)
            : { top: 0, bottom: 0, left: 0, right: 0, width: 0, height: 0 };
    }
    function p(e) {
        return !e || "x" in e
            ? e
            : {
                  top: e.top,
                  y: e.top,
                  bottom: e.bottom,
                  left: e.left,
                  x: e.left,
                  right: e.right,
                  width: e.width,
                  height: e.height,
              };
    }
    function u(e, o) {
        var a = o.top - e.top,
            n = o.left - e.left;
        return {
            top: a,
            left: n,
            height: o.height,
            width: o.width,
            bottom: a + o.height,
            right: n + o.width,
        };
    }
    function h(e, o) {
        for (var a = o; a; ) {
            if (a == e) return !0;
            a = f(a);
        }
        return !1;
    }
    function f(o) {
        var a = o.parentNode;
        return 9 == o.nodeType && o != e
            ? m(o)
            : a && 11 == a.nodeType && a.host
            ? a.host
            : a && a.assignedSlot
            ? a.assignedSlot.parentNode
            : a;
    }
    function m(e) {
        try {
            return (e.defaultView && e.defaultView.frameElement) || null;
        } catch (o) {
            return null;
        }
    }
})(),
    (function (e, o) {
        "object" == typeof exports
            ? (module.exports = o(e))
            : "function" == typeof define && define.amd
            ? define([], o)
            : (e.LazyLoad = o(e));
    })(
        "undefined" != typeof global ? global : this.window || this.global,
        function (e) {
            "use strict";
            "function" == typeof define && define.amd && (e = window);
            var o = {
                    src: "data-src",
                    srcset: "data-srcset",
                    selector: ".lazyload",
                    root: null,
                    rootMargin: "0px",
                    threshold: 0,
                },
                a = function () {
                    var e = {},
                        o = !1,
                        n = 0,
                        r = arguments.length;
                    for (
                        "[object Boolean]" ===
                            Object.prototype.toString.call(arguments[0]) &&
                        ((o = arguments[0]), n++);
                        n < r;
                        n++
                    )
                        (function (n) {
                            for (var r in n)
                                Object.prototype.hasOwnProperty.call(n, r) &&
                                    (o &&
                                    "[object Object]" ===
                                        Object.prototype.toString.call(n[r])
                                        ? (e[r] = a(!0, e[r], n[r]))
                                        : (e[r] = n[r]));
                        })(arguments[n]);
                    return e;
                };
            function n(e, n) {
                (this.settings = a(o, n || {})),
                    (this.images =
                        e || document.querySelectorAll(this.settings.selector)),
                    (this.observer = null),
                    this.init();
            }
            if (
                ((n.prototype = {
                    init: function () {
                        if (e.IntersectionObserver) {
                            var o = this,
                                a = {
                                    root: this.settings.root,
                                    rootMargin: this.settings.rootMargin,
                                    threshold: [this.settings.threshold],
                                };
                            (this.observer = new IntersectionObserver(function (
                                e
                            ) {
                                Array.prototype.forEach.call(e, function (e) {
                                    if (e.isIntersecting) {
                                        o.observer.unobserve(e.target);
                                        var a = e.target.getAttribute(
                                                o.settings.src
                                            ),
                                            n = e.target.getAttribute(
                                                o.settings.srcset
                                            );
                                        "img" === e.target.tagName.toLowerCase()
                                            ? (a && (e.target.src = a),
                                              n && (e.target.srcset = n))
                                            : (e.target.style.backgroundImage =
                                                  "url(" + a + ")");
                                    }
                                });
                            },
                            a)),
                                Array.prototype.forEach.call(
                                    this.images,
                                    function (e) {
                                        o.observer.observe(e);
                                    }
                                );
                        } else this.loadImages();
                    },
                    loadAndDestroy: function () {
                        this.settings && (this.loadImages(), this.destroy());
                    },
                    loadImages: function () {
                        if (this.settings) {
                            var e = this;
                            Array.prototype.forEach.call(
                                this.images,
                                function (o) {
                                    var a = o.getAttribute(e.settings.src),
                                        n = o.getAttribute(e.settings.srcset);
                                    "img" === o.tagName.toLowerCase()
                                        ? (a && (o.src = a),
                                          n && (o.srcset = n))
                                        : (o.style.backgroundImage =
                                              "url('" + a + "')");
                                }
                            );
                        }
                    },
                    destroy: function () {
                        this.settings &&
                            (this.observer.disconnect(),
                            (this.settings = null));
                    },
                }),
                (e.lazyload = function (e, o) {
                    return new n(e, o);
                }),
                e.jQuery)
            ) {
                var r = e.jQuery;
                r.fn.lazyload = function (e) {
                    return (
                        ((e = e || {}).attribute = e.attribute || "data-src"),
                        new n(r.makeArray(this), e),
                        this
                    );
                };
            }
            return n;
        }
    ),
    (function (e) {
        (e.isScrollToFixed = function (o) {
            return !!e(o).data("ScrollToFixed");
        }),
            (e.ScrollToFixed = function (o, a) {
                var n = this;
                (n.$el = e(o)), (n.el = o), n.$el.data("ScrollToFixed", n);
                var r,
                    s,
                    l,
                    c,
                    d = !1,
                    p = n.$el,
                    u = 0,
                    h = 0,
                    f = -1,
                    m = -1,
                    g = null;
                function v() {
                    var e = n.options.limit;
                    return e ? ("function" == typeof e ? e.apply(p) : e) : 0;
                }
                function x() {
                    return "fixed" === r;
                }
                function b() {
                    return "absolute" === r;
                }
                function C() {
                    return !(x() || b());
                }
                function y() {
                    if (!x()) {
                        var e = p[0].getBoundingClientRect();
                        g.css({
                            display: p.css("display"),
                            width: e.width,
                            height: e.height,
                            float: p.css("float"),
                        }),
                            (cssOptions = {
                                "z-index": n.options.zIndex,
                                position: "fixed",
                                top: -1 == n.options.bottom ? S() : "",
                                bottom:
                                    -1 == n.options.bottom
                                        ? ""
                                        : n.options.bottom,
                                "margin-left": "0px",
                            }),
                            n.options.dontSetWidth ||
                                (cssOptions.width = p.css("width")),
                            p.css(cssOptions),
                            p.addClass(n.options.baseClassName),
                            n.options.className &&
                                p.addClass(n.options.className),
                            (r = "fixed");
                    }
                }
                function T() {
                    var e = v(),
                        o = h;
                    n.options.removeOffsets && ((o = ""), (e -= u)),
                        (cssOptions = {
                            position: "absolute",
                            top: e,
                            left: o,
                            "margin-left": "0px",
                            bottom: "",
                        }),
                        n.options.dontSetWidth ||
                            (cssOptions.width = p.css("width")),
                        p.css(cssOptions),
                        (r = "absolute");
                }
                function w() {
                    C() ||
                        ((m = -1),
                        g.css("display", "none"),
                        p.css({
                            "z-index": c,
                            width: "",
                            position: s,
                            left: "",
                            top: l,
                            "margin-left": "",
                        }),
                        p.removeClass("scroll-to-fixed-fixed"),
                        n.options.className &&
                            p.removeClass(n.options.className),
                        (r = null));
                }
                function _(e) {
                    e != m && (p.css("left", h - e), (m = e));
                }
                function S() {
                    var e = n.options.marginTop;
                    return e ? ("function" == typeof e ? e.apply(p) : e) : 0;
                }
                function k() {
                    if (e.isScrollToFixed(p) && !p.is(":hidden")) {
                        var o = d,
                            a = C();
                        d
                            ? C() &&
                              ((u = p.offset().top), (h = p.offset().left))
                            : (p.trigger("preUnfixed.ScrollToFixed"),
                              w(),
                              p.trigger("unfixed.ScrollToFixed"),
                              (m = -1),
                              (u = p.offset().top),
                              (h = p.offset().left),
                              n.options.offsets &&
                                  (h += p.offset().left - p.position().left),
                              -1 == f && (f = h),
                              (r = p.css("position")),
                              (d = !0),
                              -1 != n.options.bottom &&
                                  (p.trigger("preFixed.ScrollToFixed"),
                                  y(),
                                  p.trigger("fixed.ScrollToFixed")));
                        var l = e(window).scrollLeft(),
                            c = e(window).scrollTop(),
                            g = v();
                        n.options.minWidth &&
                        e(window).width() < n.options.minWidth
                            ? (C() && o) ||
                              (I(),
                              p.trigger("preUnfixed.ScrollToFixed"),
                              w(),
                              p.trigger("unfixed.ScrollToFixed"))
                            : n.options.maxWidth &&
                              e(window).width() > n.options.maxWidth
                            ? (C() && o) ||
                              (I(),
                              p.trigger("preUnfixed.ScrollToFixed"),
                              w(),
                              p.trigger("unfixed.ScrollToFixed"))
                            : -1 == n.options.bottom
                            ? g > 0 && c >= g - S()
                                ? a ||
                                  (b() && o) ||
                                  (I(),
                                  p.trigger("preAbsolute.ScrollToFixed"),
                                  T(),
                                  p.trigger("unfixed.ScrollToFixed"))
                                : c >= u - S()
                                ? ((x() && o) ||
                                      (I(),
                                      p.trigger("preFixed.ScrollToFixed"),
                                      y(),
                                      (m = -1),
                                      p.trigger("fixed.ScrollToFixed")),
                                  _(l))
                                : (C() && o) ||
                                  (I(),
                                  p.trigger("preUnfixed.ScrollToFixed"),
                                  w(),
                                  p.trigger("unfixed.ScrollToFixed"))
                            : g > 0
                            ? c + e(window).height() - p.outerHeight(!0) >=
                              g -
                                  (S() ||
                                      -(n.options.bottom
                                          ? n.options.bottom
                                          : 0))
                                ? x() &&
                                  (I(),
                                  p.trigger("preUnfixed.ScrollToFixed"),
                                  "absolute" === s ? T() : w(),
                                  p.trigger("unfixed.ScrollToFixed"))
                                : (x() ||
                                      (I(),
                                      p.trigger("preFixed.ScrollToFixed"),
                                      y()),
                                  _(l),
                                  p.trigger("fixed.ScrollToFixed"))
                            : _(l);
                    }
                }
                function I() {
                    var e = p.css("position");
                    "absolute" == e
                        ? p.trigger("postAbsolute.ScrollToFixed")
                        : "fixed" == e
                        ? p.trigger("postFixed.ScrollToFixed")
                        : p.trigger("postUnfixed.ScrollToFixed");
                }
                var F = function (e) {
                        p.is(":visible") && ((d = !1), k());
                    },
                    A = function (e) {
                        window.requestAnimationFrame
                            ? requestAnimationFrame(k)
                            : k();
                    };
                (n.init = function () {
                    (n.options = e.extend(
                        {},
                        e.ScrollToFixed.defaultOptions,
                        a
                    )),
                        (c = p.css("z-index")),
                        n.$el.css("z-index", n.options.zIndex),
                        (g = e("<div />")),
                        (r = p.css("position")),
                        (s = p.css("position")),
                        p.css("float"),
                        (l = p.css("top")),
                        C() && n.$el.after(g),
                        e(window).bind("resize.ScrollToFixed", F),
                        e(window).bind("scroll.ScrollToFixed", A),
                        "ontouchmove" in window &&
                            e(window).bind("touchmove.ScrollToFixed", k),
                        n.options.preFixed &&
                            p.bind(
                                "preFixed.ScrollToFixed",
                                n.options.preFixed
                            ),
                        n.options.postFixed &&
                            p.bind(
                                "postFixed.ScrollToFixed",
                                n.options.postFixed
                            ),
                        n.options.preUnfixed &&
                            p.bind(
                                "preUnfixed.ScrollToFixed",
                                n.options.preUnfixed
                            ),
                        n.options.postUnfixed &&
                            p.bind(
                                "postUnfixed.ScrollToFixed",
                                n.options.postUnfixed
                            ),
                        n.options.preAbsolute &&
                            p.bind(
                                "preAbsolute.ScrollToFixed",
                                n.options.preAbsolute
                            ),
                        n.options.postAbsolute &&
                            p.bind(
                                "postAbsolute.ScrollToFixed",
                                n.options.postAbsolute
                            ),
                        n.options.fixed &&
                            p.bind("fixed.ScrollToFixed", n.options.fixed),
                        n.options.unfixed &&
                            p.bind("unfixed.ScrollToFixed", n.options.unfixed),
                        n.options.spacerClass &&
                            g.addClass(n.options.spacerClass),
                        p.bind("resize.ScrollToFixed", function () {
                            g.height(p.height());
                        }),
                        p.bind("scroll.ScrollToFixed", function () {
                            p.trigger("preUnfixed.ScrollToFixed"),
                                w(),
                                p.trigger("unfixed.ScrollToFixed"),
                                k();
                        }),
                        p.bind("detach.ScrollToFixed", function (o) {
                            var a;
                            (a = (a = o) || window.event).preventDefault &&
                                a.preventDefault(),
                                (a.returnValue = !1),
                                p.trigger("preUnfixed.ScrollToFixed"),
                                w(),
                                p.trigger("unfixed.ScrollToFixed"),
                                e(window).unbind("resize.ScrollToFixed", F),
                                e(window).unbind("scroll.ScrollToFixed", A),
                                p.unbind(".ScrollToFixed"),
                                g.remove(),
                                n.$el.removeData("ScrollToFixed");
                        }),
                        F();
                }),
                    n.init();
            }),
            (e.ScrollToFixed.defaultOptions = {
                marginTop: 0,
                limit: 0,
                bottom: -1,
                zIndex: 1e3,
                baseClassName: "scroll-to-fixed-fixed",
            }),
            (e.fn.scrollToFixed = function (o) {
                return this.each(function () {
                    new e.ScrollToFixed(this, o);
                });
            });
    })(jQuery);
var t,
    siteRoot = "",
    hostName = "";
gOpts.host && ((hostName = gOpts.host), (siteRoot = "//" + gOpts.host));
var AjaxHelper = {
    loadWaiting: !1,
    init: function () {
        this.loadWaiting = !1;
    },
    setLoadWaiting: function (e) {
        var o =
            '<div id="loading" style="display:block"><img src="' +
            hostName +
            '/frontend-web/images/loading-small.gif" alt="loading"><span>処理</span></div>';
        if (!0 === e)
            document.querySelector("body").insertAdjacentHTML("beforeend", o);
        else if (null != document.querySelector("#loading")) {
            var a = document.querySelector("#loading");
            a.parentElement.removeChild(a);
        }
        this.loadWaiting = e;
    },
    processAjaxError: function (e) {
        alert("エラーが発生しました。 もう一度お試しください..."),
            setTimeout(function () {
                location.reload();
            }, 100);
    },
    changeLevelText: function () {
        try {
            if (gOpts.levelType) {
                var e = [];
                (e.TT = [
                    "Luyện Kh\xed",
                    "Tr\xfac Cơ",
                    "Kim Đan",
                    "Nguy\xean Anh",
                    "H\xf3a Thần",
                    "Luyện Hư",
                    "Hợp Thể",
                    "Đại Thừa",
                    "Độ Kiếp",
                    "Phi Thăng",
                ]),
                    (e.TK = [
                        "Học Đồ",
                        "H\xe0nh Tinh",
                        "Hằng Tinh",
                        "Vũ Trụ",
                        "Vực Chủ",
                        "Giới Chủ",
                        "Bất Hủ",
                        "T\xf4n Giả",
                        "Chi Chủ",
                        "Ch\xe2n Thần",
                    ]),
                    $("span[data-level]").each(function () {
                        var o = $(this).attr("data-level");
                        o &&
                            e[gOpts.levelType] &&
                            e[gOpts.levelType].length > o - 1 &&
                            $(this).text(e[gOpts.levelType][o - 1]);
                    });
            }
        } catch (o) {}
    },
};
function PopulateData() {
    if ($("body").hasClass("chapter-detail")) processComicLoader(!0);
    else if ($("body").hasClass("comic-detail")) processComicLoader(!1);
    else if (
        $(".comics-followed-page").length ||
        $(".comics-followed").length
    ) {
        var e = 0,
            o = $(".comics-followed-page");
        if ($(".comics-followed-nopaging").length)
            (e = 1), (o = $(".comics-followed"));
        else if ($(".comics-followed-withpaging").length)
            (e = 2), (o = $(".comics-followed"));
        else {
            var a = getParameterByName("t");
            3 == a && (e = a);
        }
        !(function (e, o) {
            if (0 == AjaxHelper.loadWaiting) {
                AjaxHelper.setLoadWaiting(!0);
                var a = getParameterByName("page");
                null == a && (a = 1),
                    $.ajax({
                        type: "GET",
                        url:
                            siteRoot +
                            "/Comic/Services/ComicService.asmx/GetFollowedPageComics",
                        data: {
                            page: a,
                            userGuid: getUserGuid(),
                            loadType: o,
                            token: gOpts.token ? gOpts.token : "",
                        },
                        success: function (a) {
                            a.success &&
                                (a.followedListHtml
                                    ? (e.html(replaceUrl(a.followedListHtml)),
                                      initLazyload(),
                                      loadTooltip(),
                                      a.pagerHtml &&
                                          $(
                                              '<div class="pagination-outter"></div>'
                                          )
                                              .html(a.pagerHtml)
                                              .appendTo(e),
                                      $("html, body").animate(
                                          { scrollTop: 0 },
                                          0,
                                          "linear"
                                      ))
                                    : 0 == o &&
                                      e.html(
                                          '<p>あなたはまだストーリーをフォローしていません。ストーリーをフォローするには、以下の画像のように<u>フォロー</u>をクリックしてください。<br />あなたがフォローしたストーリーにどこにいてもアクセスするには、<a href="/Secure/Login.aspx">ログイン</a>してください。</p><p class="text-center"><img src="/public/assets/images/huong-dan-theo-doi-truyen.jpg" width="660" style="aspect-ratio:1.52" alt="漫画をフォローする方法"></img></p>'
                                      ));
                        },
                        complete: function (e) {
                            AjaxHelper.setLoadWaiting(!1);
                        },
                        error: function (e, o, a) {
                            console.log(a);
                        },
                    });
            }
        })(o, e);
    }
    setupLazyLoad(".comics-followed-block");
}
function InitNotifications(e) {
    if (e) {
        var o =
            '<div class="notifications"><a href="#" title="お知らせ"><i class="fa fa-comment"></i>';
        e.unread &&
            e.unread > 0 &&
            (o += '<span class="notification-count">' + e.unread + "</span>"),
            $((o += "</a></div>")).insertBefore($(".search-button-icon"));
    }
    $("body").on("click", ".notifications > a", function (e) {
        if ((e.preventDefault(), 0 == AjaxHelper.loadWaiting))
            return (
                AjaxHelper.setLoadWaiting(!0),
                $.ajax({
                    type: "POST",
                    url: "/Comic/Services/ComicService.asmx/GetNotifications",
                    data: { page: 1 },
                    success: function (e) {
                        e.success &&
                            (e.notifications &&
                                ($(".notification-popup").remove(),
                                $('<div class="notification-popup"></div>')
                                    .html(e.notifications)
                                    .appendTo($(".notifications")),
                                $(".notifications .notification-count").text(
                                    "0"
                                )),
                            SetUserStorage());
                    },
                    complete: function (e) {
                        AjaxHelper.setLoadWaiting(!1);
                    },
                    error: function (e, o, a) {},
                }),
                !1
            );
    }),
        $("body").on(
            "click",
            ".notifications .notification-popup .notification-content a",
            function (e) {
                e.preventDefault();
                var o = $(this);
                return (
                    $.ajax({
                        type: "POST",
                        url: "/Comic/Services/ComicService.asmx/ReadNotification",
                        data: { id: o.attr("data-id") },
                        success: function (e) {
                            window.location.href = o.attr("href");
                        },
                        complete: function (e) {
                            AjaxHelper.setLoadWaiting(!1);
                        },
                        error: function (e, o, a) {},
                    }),
                    !1
                );
            }
        );
}
function InitAccountMenu(e) {
    if (e) {
        if (0 == e.status) {
            var o = window.location.search,
                a =
                    "?returnurl=" +
                    encodeURIComponent(window.location.pathname + o);
            o && o.indexOf("?returnurl=") > -1 && (a = o);
            var n =
                '<li class="login-link"><a rel="nofollow" href="/Secure/Login.aspx' +
                a +
                '">ログイン</a></li>';
            (n +=
                '<li class="register-link"><a rel="nofollow" href="/Secure/Register.aspx' +
                a +
                '">無料登録</a></li>'),
                $(".nav-account").html(n),
                (gOpts.login = 0);
        } else
            (n = '<li class="dropdown">'),
                (n +=
                    '<a data-toggle="dropdown" class="user-menu fn-userbox dropdown-toggle" href="javascript:void(0)"><img class="fn-thumb" alt="Avatar" src="' +
                    e.avatar +
                    '" /> <span>個人</span> <i class="fa fa-caret-down"></i></a>'),
                (n += '<ul class="dropdown-menu">'),
                (n +=
                    '<li><a rel="nofollow" href="/Secure/Dashboard.aspx"><i class="fa fa-user"></i> 個人ページ</a></li><li><a rel="nofollow" href="/Secure/ComicFollowed.aspx"><i class="fa fa-book"></i> ストーリーをたどる</a></li><li><a rel="nofollow" class="user-logout" href="/Logoff.aspx"><i class="fa fa-sign-out"></i> 出口</a></li>'),
                (n += "</ul>"),
                (n += "</li>"),
                $(".nav-account").html(n),
                (gOpts.login = 1);
    }
    $("body").on("click", ".user-logout", function (e) {
        SetUserStorage();
    }),
        $(".nav-account>li").hover(
            function () {
                $(this).addClass("open");
            },
            function () {
                $(this).removeClass("open");
            }
        ),
        isMobileDevice &&
            $(".nav-account>li.dropdown>a").click(function () {
                return InitDropdownMenuOnMobile(this), !1;
            });
}
var followedOnChapter = !0;
function processComicLoader(e) {
    var o = gOpts.comicId;
    if (0 == e) {
        var a = -1,
            n = window.location.hash.split("#cmt-");
        0 == isNaN(parseInt(n[1])) &&
            parseInt(n[1]) > 0 &&
            (a = parseInt(n[1]));
        var r = { comicId: o, commentId: a };
        a > 0 &&
            $.ajax({
                type: "POST",
                url: "/Comic/Services/ComicService.asmx/ProcessComicLoader",
                data: r,
                success: function (e) {
                    e.success &&
                        (e.commentCount &&
                            $(".comment-count").text(e.commentCount),
                        e.commentsHtml &&
                            ($(".journalItems").html(e.commentsHtml),
                            e.pagerHtml &&
                                ($(".sort-comment")
                                    .parent()
                                    .removeClass("hidden"),
                                $(".commentpager").html(e.pagerHtml)),
                            shortenCommentText(),
                            AjaxHelper.changeLevelText()),
                        e.followedListHtml &&
                            ($(".comics-followed-block").html(
                                e.followedListHtml
                            ),
                            initLazyload()),
                        e.followHtml && $(".follow").prepend(e.followHtml),
                        e.readHtml &&
                            ($(".read-continue").length
                                ? $(".read-continue").attr(
                                      "href",
                                      $(e.readHtml).attr("href")
                                  )
                                : $(".read-action").append(e.readHtml)),
                        e.markAsReadHtml &&
                            $(".list-chapter h2.list-title").append(
                                e.markAsReadHtml
                            ),
                        e.readChapters &&
                            e.readChapters.length > 0 &&
                            $(".list-chapter .chapter a").each(function () {
                                !$(this).hasClass("visited") &&
                                    $.inArray(
                                        $(this).attr("data-id"),
                                        e.readChapters
                                    ) > -1 &&
                                    $(this).addClass("visited");
                            }),
                        e.commentReplyHtml &&
                            ($("body")
                                .addClass("modal-open")
                                .prepend(e.commentReplyHtml),
                            shortenCommentText(),
                            AjaxHelper.changeLevelText()));
                },
            });
    }
    // $.ajax({
    //     type: "GET",
    //     url:
    //         siteRoot +
    //         "/Comic/Services/ComicService.asmx/GetFollowedButtonComic",
    //     data: {
    //         comicId: o,
    //         userGuid: getUserGuid(),
    //         token: gOpts.token ? gOpts.token : "",
    //     },
    //     success: function (o) {
    //         o.success &&
    //             (0 == o.isFollowed && (followedOnChapter = !1),
    //             o.followHtml &&
    //                 ($(".follow-hidden").length
    //                     ? $(".follow-hidden").replaceWith(o.followHtml)
    //                     : 1 == e
    //                     ? $("#chapterNav").append(o.followHtml)
    //                     : $(".follow").prepend(o.followHtml)),
    //             o.readHtml &&
    //                 ($(".read-continue").length
    //                     ? $(".read-continue").attr(
    //                           "href",
    //                           $(o.readHtml).attr("href")
    //                       )
    //                     : $(".read-action").append(replaceUrl(o.readHtml))),
    //             o.markAsReadHtml &&
    //                 $(".list-chapter h2.list-title").append(o.markAsReadHtml),
    //             o.readChapters &&
    //                 o.readChapters.length > 0 &&
    //                 $(".list-chapter .chapter a").each(function () {
    //                     !$(this).hasClass("visited") &&
    //                         $.inArray($(this).attr("data-id"), o.readChapters) >
    //                             -1 &&
    //                         $(this).addClass("visited");
    //                 }));
    //     },
    //     error: function (e, o, a) {},
    // });
}
function findChapter() {
    var e = $(".chapter-list-modal input").val();
    e.length > 0
        ? ((e = e.toLowerCase()),
          $(".chapter-list-modal .chapter-list a").each(function () {
              var o = $(this).text().toLowerCase().replace("chapter ", "");
              o.indexOf(":") > -1 && (o = o.substring(0, o.indexOf(":") + 1)),
                  0 == o.indexOf(e) ? $(this).show() : $(this).hide();
          }))
        : $(".chapter-list-modal a").show();
}
function initLazyload() {
    $("img.lazy").lazyload({ src: "data-original", rootMargin: "50px" });
}
function getUserGuid() {
    return gOpts.userGuid ? gOpts.userGuid : null;
}
function replaceUrl(e) {
    return e;
}
var isMobile = {
        Android: function () {
            return navigator.userAgent.match(/Android/i);
        },
        BlackBerry: function () {
            return navigator.userAgent.match(/BlackBerry/i);
        },
        iOS: function () {
            return navigator.userAgent.match(/iPhone|iPad|iPod/i);
        },
        Opera: function () {
            return navigator.userAgent.match(/Opera Mini/i);
        },
        Windows: function () {
            return navigator.userAgent.match(/IEMobile/i);
        },
        any: function () {
            return (
                isMobile.Android() ||
                isMobile.BlackBerry() ||
                isMobile.iOS() ||
                isMobile.Opera() ||
                isMobile.Windows()
            );
        },
    },
    isMobileDevice = isMobile.any(),
    loadFromStorage = !1;
try {
    if ("undefined" != typeof Storage && void 0 !== localStorage["user-auth"]) {
        var e = JSON.parse(localStorage["user-auth"]);
        if (e.date) {
            var o = new Date(),
                a = new Date(e.date),
                n = (o.getTime() - a.getTime()) / 1e3;
            e.levelType && (gOpts.levelType = e.levelType),
                (loadFromStorage = !0),
                PopulateUserData(e);
        }
    }
} catch (r) {
    console.log(r);
}
function PopulateUserData(e) {
    (gOpts.userGuid = e.userGuid),
        (gOpts.token = e.token),
        (gOpts.readToken = e.readToken),
        (gOpts.fullName = e.fullName),
        (gOpts.email = e.email),
        (gOpts.levelType = e.levelType),
        InitNotifications(e),
        InitAccountMenu(e),
        PopulateData(),
        AjaxHelper.changeLevelText();
}
function SetUserStorage(e) {
    if ("undefined" != typeof Storage) {
        if (e) {
            if (!$("body").hasClass("securepage")) {
                var o = e;
                (o.date = new Date()),
                    (localStorage["user-auth"] = JSON.stringify(o));
            }
        } else
            void 0 !== localStorage["user-auth"] &&
                localStorage.removeItem("user-auth");
    }
}
function UpdateUserReadToken(e) {
    if ("undefined" != typeof Storage && void 0 !== localStorage["user-auth"]) {
        var o = JSON.parse(localStorage["user-auth"]);
        (o.readToken = e), (localStorage["user-auth"] = JSON.stringify(o));
    }
}
// 0 == loadFromStorage &&
//     $.ajax({
//         type: "GET",
//         url: siteRoot + "/Comic/Services/ComicService.asmx/CheckAuth",
//         xhrFields: { withCredentials: !0 },
//         success: function (e) {
//             e.success && (PopulateUserData(e), SetUserStorage(e));
//         },
//     }),
$("body").hasClass("securepage") &&
    (SetUserStorage(),
    $("body").hasClass("clearauth") &&
        $.ajax({
            type: "GET",
            url: siteRoot + "/Comic/Services/ComicService.asmx/ClearAuth",
            xhrFields: { withCredentials: !0 },
            success: function (e) {},
        })),
    $("span.downarr a").click(function () {
        HideMenuToolbar(), Set_Cookie("openstate", "closed", 1, "/");
    }),
    $("span.showbar a").click(function () {
        ShowMenuToolbar(), Set_Cookie("openstate", "open", 1, "/");
    }),
    $("span.downarr a, span.showbar a").click(function () {
        return !1;
    });
var openState = Get_Cookie("openstate");
null != openState &&
    ("closed" == openState && HideMenuToolbar(),
    "open" == openState && ShowMenuToolbar()),
    $("#back-to-top").fadeIn(),
    $("#back-to-top").click(function () {
        return $("body,html").animate({ scrollTop: 0 }, 200), !1;
    });
var wWidth = window.innerWidth;
$(".comicsearchbox input[type='submit']").click(function () {
    var e = $(".suggestsearch");
    if ($(e).find("li.selected").length) {
        var o = $(e).find("li.selected").eq(0).children("a").attr("href");
        return (window.location.href = o), !1;
    }
    var a = $(this).parents(".comicsearchbox").find("input[type='text']");
    return "" == a.val()
        ? (a.focus(), !1)
        : ((window.location.href =
              "/search/manga?keyword=" +
              encodeURIComponent(a.val()).replace(/%20/g, "+")),
          !1);
});
var isNoReferrer = !1,
    suggestTimeout = null;
function SuggestSearch(e, o) {
    0 == isNoReferrer && (SetReferrerPolicy(!0), (isNoReferrer = !0));
    var a,
        n = $(e).parent().find(".suggestsearch ul");
    40 != o.which
        ? 38 != o.which
            ? 13 != o.which
                ? (clearTimeout(suggestTimeout),
                  (suggestTimeout = setTimeout(function () {
                      var o = $(e).parent();
                      $(o).find(".suggestsearch").length ||
                          $(o).append("<div class='suggestsearch'></div>");
                      var a = $(o).find(".suggestsearch"),
                          n = $(e).val().trim().toLowerCase();
                      n.length < 1
                          ? $(a).hide()
                          : n.length >= 1 &&
                            ($(e).addClass("loading"),
                            $.ajax({
                                url: "/search/suggest",
                                type: "GET",
                                dataType: "html",
                                data: { q: n },
                                cache: !0,
                                success: function (o) {
                                    $(e).removeClass("loading"),
                                        "" == o || " " == o
                                            ? $(a).hide()
                                            : $(a).html(o).show(),
                                        1 == callInitFrom404 &&
                                            ($(
                                                ".pagenotfound .not-found .searchinput"
                                            ).val(""),
                                            (callInitFrom404 = !1));
                                },
                            }));
                  }, 300)))
                : $(e).parent().find(".searchbutton").trigger("click")
            : 0 == $(n).find(".selected").length
            ? $(n).find("li").last().addClass("selected")
            : ((a = $(n).find(".selected").prev()).hasClass("li-group") &&
                  (a = a.prev()),
              $(n).find(".selected").removeClass("selected"),
              a.addClass("selected"))
        : 0 == $(n).find(".selected").length
        ? $(n).find("li").first().addClass("selected")
        : ((a = $(n).find(".selected").next()).hasClass("li-group") &&
              (a = a.next()),
          $(n).find(".selected").removeClass("selected"),
          a.addClass("selected"));
}
$(".comicsearchbox input[type='text']").keyup(function (e) {
    SuggestSearch(this, e);
}),
    $(".comicsearchbox input[type='text']")
        .focus(function () {
            wWidth < 768
                ? $(".search-box").addClass("search-box-expanded")
                : $(".search-box").removeClass("search-box-expanded"),
                window.scrollTo(0, window.scrollY);
        })
        .blur(function () {
            $(".search-box").removeClass("search-box-expanded");
        }),
    $(document).on("click", function (e) {
        0 === $(e.target).closest(".suggestsearch").length &&
            $(".suggestsearch").hide(),
            0 === $(e.target).closest(".notification-popup").length &&
                $(".notification-popup").remove(),
            0 ===
                $(e.target).closest(".comment-wrapper .comment-more").length &&
                0 ===
                    $(e.target).closest(".comment-wrapper .more-action")
                        .length &&
                $(".comment-wrapper .comment-more").addClass("hidden");
    });
var elementScrollToFixed,
    callInitFrom404 = !1;
if ($("body").hasClass("pagenotfound")) {
    $(".pagenotfound .searchbutton").click(function () {
        var e = $(this).parents(".comicsearchbox").find(".searchinput");
        return (
            e.val().length &&
                (location.href =
                    "/search/manga?keyword=" +
                    encodeURIComponent(e.val()).replace(/%20/g, "+")),
            !1
        );
    }),
        $(".pagenotfound .comicsearchbox input[type='text']").keyup(function (
            e
        ) {
            13 != e.which ||
                $(".pagenotfound .comicsearchbox .searchbutton").trigger(
                    "click"
                );
        });
    var s = window.location.pathname,
        l = "",
        c = !1;
    if (
        (0 == s.indexOf("/manga/") &&
            ((l = s.replace("/manga/", "")),
            s.indexOf("/chap-") > -1 && (c = !0)),
        "" != l)
    ) {
        var d = l.split("/");
        if (d.length > 0) {
            callInitFrom404 = !0;
            for (
                var p = "",
                    u = "",
                    h = d[0].split("-"),
                    f = 1 == c ? h.length : h.length - 1,
                    m = 0;
                m < f;
                m++
            )
                (p += u + h[m]), (u = " ");
            $(".pagenotfound .not-found .searchinput")
                .val(p)
                .focus()
                .trigger("keyup");
        }
    }
}
function InitDropdownMenuOnMobile(e) {
    $(e).parent().hasClass("open")
        ? $("li.dropdown.open").removeClass("open")
        : ($("li.dropdown.open").removeClass("open"),
          $(e).parent().addClass("open"));
}
$(".alertError").click(function () {
    var e = gOpts.chapterId;
    $.ajax({
        url: "/Comic/Services/ComicService.asmx/ReportChapterForm",
        type: "post",
        dataType: "json",
        data: { chapterId: e },
        success: function (o) {
            o.success &&
                o.reportFormHtml &&
                ($("body").addClass("modal-open").append(o.reportFormHtml),
                $(".btn-send-report").click(function () {
                    var o = $(".ddl-error-type").val(),
                        a = $(".error-content input").val();
                    if ("-1" == o)
                        return (
                            $(".ddl-error-type").focus(),
                            void alert("Vui l\xf2ng chọn loại lỗi.")
                        );
                    if ("" == a)
                        return (
                            $(".error-content input").focus(),
                            void alert("Vui l\xf2ng nhập Nội dung lỗi")
                        );
                    if (0 == AjaxHelper.loadWaiting) {
                        AjaxHelper.setLoadWaiting(!0);
                        var n = "";
                        $(".g-recaptcha").length &&
                            (n = grecaptcha.getResponse()),
                            $.ajax({
                                url: "/Comic/Services/ComicService.asmx/ReportChapter",
                                type: "post",
                                dataType: "json",
                                data: {
                                    chapterId: e,
                                    errorType: o,
                                    errorText: a,
                                    captcha: n,
                                },
                                success: function (e) {
                                    e.message && alert(e.message),
                                        e.success &&
                                            ($("body").removeClass(
                                                "modal-open"
                                            ),
                                            $(".modal").remove(),
                                            $(".modal-backdrop").remove());
                                },
                                complete: function (e) {
                                    AjaxHelper.setLoadWaiting(!1);
                                },
                            });
                    }
                }),
                $(".ddl-error-type").change(function () {
                    $(".report-note").text("");
                    var e = $(this).find("option:selected");
                    null != e && $(".report-note").text(e.attr("rel"));
                }));
        },
    });
}),
    // $("body").on("click", ".follow-link", function () {
    //     if (0 == AjaxHelper.loadWaiting) {
    //         AjaxHelper.setLoadWaiting(!0);
    //         var e = $(this),
    //             o = null,
    //             a = $(e).attr("data-id");
    //         $("body").hasClass("comic-detail") && (o = $(e).parent().find("b")),
    //             $.ajax({
    //                 url:
    //                     siteRoot +
    //                     "/Comic/Services/ComicService.asmx/GetFollowToken",
    //                 xhrFields: { withCredentials: !0 },
    //                 type: "post",
    //                 dataType: "json",
    //                 data: {
    //                     comicId: a,
    //                     token: gOpts.key ? gOpts.key : $(e).attr("data-key"),
    //                 },
    //                 cache: !0,
    //                 success: function (n) {
    //                     n && n.success
    //                         ? $.ajax({
    //                               url:
    //                                   siteRoot +
    //                                   "/Comic/Services/ComicService.asmx/Follow",
    //                               xhrFields: { withCredentials: !0 },
    //                               type: "post",
    //                               dataType: "json",
    //                               data: { comicId: a, token: n.data },
    //                               cache: !0,
    //                               success: function (a) {
    //                                   a && a.success
    //                                       ? (1 == a.status
    //                                             ? ($(e).html(
    //                                                   '<i class="fa fa-times"></i> <span>フォロー解除</span>'
    //                                               ),
    //                                               $(e).hasClass(
    //                                                   "btn-success"
    //                                               ) &&
    //                                                   $(e)
    //                                                       .removeClass(
    //                                                           "btn-success"
    //                                                       )
    //                                                       .addClass(
    //                                                           "btn-danger"
    //                                                       ))
    //                                             : ($(e).html(
    //                                                   '<i class="fa fa-heart"></i> <span>ブックマーク</span>'
    //                                               ),
    //                                               $(e).hasClass("btn-danger") &&
    //                                                   $(e)
    //                                                       .removeClass(
    //                                                           "btn-danger"
    //                                                       )
    //                                                       .addClass(
    //                                                           "btn-success"
    //                                                       )),
    //                                         null != o &&
    //                                             o.text(a.followedCount),
    //                                         SetUserStorage())
    //                                       : a.message && alert(a.message);
    //                               },
    //                           })
    //                         : n.message && alert(n.message);
    //                 },
    //                 complete: function (e) {
    //                     AjaxHelper.setLoadWaiting(!1);
    //                 },
    //                 error: function (e, o, a) {
    //                     AjaxHelper.processAjaxError(a);
    //                 },
    //             });
    //     }
    // }),

    $("body").on("click", ".follow-link", function () {
        const e = $(this);
        const comicId = $(e).attr("data-id");
        const isFollowing = $(e).hasClass("btn-danger");

        let bookmarkIds = JSON.parse(localStorage.getItem("bookmarkIds")) || [];

        if (isFollowing) {
            bookmarkIds = bookmarkIds.filter((id) => id !== comicId);
            $(e)
                .html('<i class="fa fa-heart"></i> <span>ブックマーク</span>')
                .removeClass("btn-danger")
                .addClass("btn-success");
        } else {
            // Nếu không theo dõi (btn-success), thêm comicId vào mảng bookmarkIds
            bookmarkIds.push(comicId);
            $(e)
                .html('<i class="fa fa-times"></i> <span>フォロー解除</span>')
                .removeClass("btn-success")
                .addClass("btn-danger");
        }

        // Cập nhật localStorage với mảng bookmarkIds mới
        localStorage.setItem("bookmarkIds", JSON.stringify(bookmarkIds));

        // Cập nhật số lượng đã theo dõi nếu cần
        const o = $("body").hasClass("comic-detail")
            ? $(e).parent().find("b")
            : null;
        if (o) {
            o.text(bookmarkIds.length);
        }
    }),
    $("body").on("click", '.modal button[data-dismiss="modal"]', function () {
        $("body").removeClass("modal-open"),
            $(".modal").remove(),
            $(".modal-backdrop").remove();
        var e = $(".chapter-detail .select-chapter");
        e.length && e.is(":disabled") && e.prop("disabled", !1);
    }),
    $("body").on("click", ".mark-as-read", function (e) {
        e.preventDefault();
        var o = $(this);
        return (
            $.ajax({
                type: "POST",
                url: siteRoot + "/Comic/Services/ComicService.asmx/MarkAsRead",
                xhrFields: { withCredentials: !0 },
                data: { comicId: o.attr("data-id"), userGuid: getUserGuid() },
                success: function (e) {
                    o.parents(".unread").find(".chapter a").addClass("visited"),
                        o.parents(".unread").removeClass(".unread"),
                        o
                            .parents(".list-chapter")
                            .find(".chapter a")
                            .addClass("visited"),
                        o.remove();
                },
            }),
            !1
        );
    }),
    $("body").on("click", ".read-remove", function (e) {
        e.preventDefault();
        var o = $(this);
        return (
            $.ajax({
                type: "POST",
                url: siteRoot + "/Comic/Services/ComicService.asmx/ReadRemove",
                xhrFields: { withCredentials: !0 },
                data: { comicId: o.attr("data-id"), token: o.attr("data-key") },
                success: function (e) {
                    e.success &&
                        e.readToken &&
                        (o.parents(".item-read").remove(),
                        UpdateUserReadToken(e.readToken));
                },
            }),
            !1
        );
    }),
    $(".changed-redirect").change(function () {
        window.location = $(this).val();
    }),
    $(".navbar-nav>li").hover(
        function () {
            $(".navbar-nav > li.active").removeClass("active").addClass("curr"),
                $(this).addClass("open");
        },
        function () {
            $(".navbar-nav > li.curr").removeClass("curr").addClass("active"),
                $(this).removeClass("open");
        }
    ),
    isMobileDevice &&
        $(".main-menu>li.dropdown>a").click(function () {
            return InitDropdownMenuOnMobile(this), !1;
        }),
    $(".nav-tabs li a").click(function () {
        return (
            $(".nav-tabs li").removeClass("active"),
            $(".tab-content .tab-pane").removeClass("active").removeClass("in"),
            $(this).parent().addClass("active"),
            $($(this).attr("href")).addClass("active").addClass("in"),
            !1
        );
    }),
    $(".megamenu ul li a").hover(
        function () {
            $(".megamenu p")
                .addClass("separator")
                .text($(this).attr("data-title"));
        },
        function () {
            $(".megamenu p").removeClass("separator").text("");
        }
    ),
    $(".navbar-toggle").click(function () {
        $("body").hasClass("menu-open")
            ? ($("body").removeClass("menu-open"),
              $(this).find(".fa").removeClass("fa-times").addClass("fa-bars"))
            : ($("body").addClass("menu-open"),
              $(this).find(".fa").removeClass("fa-bars").addClass("fa-times"));
    }),
    $(".search-button-icon").click(function () {
        $(".navbar-toggle").trigger("click"),
            $(".navbar-collapse .searchinput").focus();
    }),
    $(".navbar-collapse .searchinput").focus(function () {
        window.scrollTo(0, 0);
    }),
    isMobileDevice && $(".facebook-like .tip").addClass("hidden");
try {
    if (top.location.hostname != self.location.hostname) throw 1;
} catch (g) {
    top.location.href = self.location.href;
}
if ($(".items-slide").length) {
    var v = $(".items-slide .owl-carousel");
    v.owlCarousel({
        lazyLoad: !0,
        autoPlay: 5e3,
        stopOnHover: !0,
        slideSpeed: 300,
        pagination: !1,
        paginationSpeed: 800,
        itemsCustom: [
            [0, 1],
            [360, 2],
            [480, 3],
            [768, 4],
            [992, 5],
        ],
    }),
        $(".items-slide .next").click(function () {
            return v.trigger("owl.next"), !1;
        }),
        $(".items-slide .prev").click(function () {
            return v.trigger("owl.prev"), !1;
        });
}
function loadTooltip() {
    isMobileDevice ||
        $(".jtip")
            .hover(
                function () {
                    var e = $($(this).data("jtip"));
                    if (!e.length) return !1;
                    e
                        .find(".box_img img")
                        .attr(
                            "src",
                            e.find(".box_img img").attr("data-original")
                        ),
                        $('<div id="cluetip"></div>')
                            .html(e.html())
                            .appendTo("body")
                            .fadeIn("300");
                },
                function () {
                    $("#cluetip").remove();
                }
            )
            .mousemove(function (e) {
                var o = e.pageX + 20,
                    a = e.pageY + 10;
                $("#cluetip").css({ top: a, left: o });
            });
}
initLazyload(),
    loadTooltip(),
    $(".star").length &&
        $(".star").raty({
            path: "//" + hostName + "/public/assets/images/",
            score: function () {
                return $(this).attr("data-rating");
            },
            half: !0,
            readOnly: "false" == $(".star").attr("data-allowrating"),
            click: function (e, o) {
                var a = {
                    comicId: $(this).attr("data-id"),
                    rate: parseInt(e),
                    token: gOpts.key,
                };
                $.ajax({
                    type: "POST",
                    url: "/Comic/Services/ComicService.asmx/Rating",
                    data: a,
                    success: function (e) {
                        e.message && alert(e.message);
                    },
                    error: function (e, o, a) {
                        AjaxHelper.processAjaxError(a);
                    },
                });
            },
        });
var isHeaderScrollToFixed = !1,
    hasScrollFixed = !1;
if (
    ($("body").hasClass("chapter-detail")
        ? (elementScrollToFixed = $("#chapterNav"))
        : wWidth >= 768
        ? (elementScrollToFixed = $("#mainNav"))
        : ((isHeaderScrollToFixed = !0), (elementScrollToFixed = $("#header"))),
    elementScrollToFixed.scrollToFixed({
        preFixed: function () {
            hasScrollFixed = !0;
        },
        preUnfixed: function () {
            hasScrollFixed = !1;
        },
    }),
    isMobileDevice)
) {
    var x = !1;
    try {
        var b = Object.defineProperty({}, "passive", {
            get: function () {
                x = !0;
            },
        });
        window.addEventListener("testPassive", null, b),
            window.removeEventListener("testPassive", null, b);
    } catch (C) {}
    var y = !1,
        T = 0,
        w = 5,
        _ = 0,
        S = 0;
    function k() {
        timer = setTimeout(function () {
            if (1 == y) {
                var e = $(this).scrollTop();
                if (
                    (e > 200
                        ? 1 != S &&
                          ((S = 1),
                          $("#back-to-top").css("visibility", "visible"))
                        : -1 != S &&
                          ((S = -1),
                          $("#back-to-top").css("visibility", "hidden")),
                    Math.abs(T - e) <= w)
                )
                    return void (y = !1);
                1 == hasScrollFixed
                    ? e < T || e < 100
                        ? 1 != _ &&
                          ((_ = 1),
                          1 == isHeaderScrollToFixed &&
                              elementScrollToFixed
                                  .find(".logo")
                                  .css("visibility", "visible"),
                          elementScrollToFixed.css("visibility", "visible"))
                        : -1 != _ &&
                          ((_ = -1),
                          1 == isHeaderScrollToFixed &&
                              elementScrollToFixed
                                  .find(".logo")
                                  .css("visibility", "hidden"),
                          elementScrollToFixed.css("visibility", "hidden"))
                    : 1 != _ &&
                      ((_ = 1),
                      1 == isHeaderScrollToFixed &&
                          elementScrollToFixed
                              .find(".logo")
                              .css("visibility", "visible"),
                      elementScrollToFixed.css("visibility", "visible")),
                    (y = !1),
                    (T = e);
            }
        }, 200);
    }
    $("#back-to-top").css("visibility", "hidden"),
        document.addEventListener(
            "scroll",
            function (e) {
                0 == y && ((y = !0), k());
            },
            1 == x && { passive: !0 }
        );
}
if (
    (($.fn.shorten = function (e) {
        var o = {
            maxHeight: 42,
            ellipsesText: "...",
            moreText: "続きを見る <i class='fa fa-angle-right'></i>",
            lessText: "<i class='fa fa-angle-left'></i> 崩壊",
        };
        return (
            e && $.extend(o, e),
            $(document).off("click", ".morelink"),
            $(document).on(
                {
                    click: function () {
                        var e = $(this);
                        return (
                            e.hasClass("less")
                                ? (e.removeClass("less"),
                                  e.html(o.moreText),
                                  e.prev().addClass("shortened"))
                                : (e.addClass("less"),
                                  e.html(o.lessText),
                                  e.prev().removeClass("shortened")),
                            !1
                        );
                    },
                },
                ".morelink"
            ),
            this.each(function () {
                var e = $(this);
                e.hasClass("shortened") ||
                    (e.height() > o.maxHeight &&
                        (e.addClass("shortened"),
                        $(
                            '<a href="#" class="morelink">' +
                                o.moreText +
                                "</a>"
                        ).insertAfter(e)));
            })
        );
    }),
    $(".detail-content p").shorten(),
    $(".show-top-images a").click(function () {
        for (
            var e = 1, o = $(".page-hidden").length - 1;
            o >= 0 && !(e > 3);
            o--
        ) {
            var a = $(".page-hidden img").eq(o);
            a.attr("src", a.attr("data-original")),
                a.parent().show().removeClass("page-hidden"),
                (e += 1);
        }
        return (
            $(this).parent().remove(),
            $(".show-images").removeClass("hidden"),
            !1
        );
    }),
    $(".show-images a").click(function () {
        return (
            $(".page-hidden img").each(function () {
                $(this).attr("src", $(this).attr("data-original")),
                    $(this).parent().show().removeClass("page-hidden");
            }),
            $(this).parent().remove(),
            !1
        );
    }),
    $(".user-sidebar").click(function () {
        var e = $(this).find(".fa");
        e.hasClass("fa-angle-down")
            ? ($(".user-sidelink").addClass("hidden"),
              e
                  .removeClass("active")
                  .removeClass("fa-angle-down")
                  .addClass("fa-angle-up"))
            : ($(".user-sidelink").removeClass("hidden"),
              e
                  .addClass("active")
                  .removeClass("fa-angle-up")
                  .addClass("fa-angle-down"));
    }),
    wWidth < 768 && $(".user-sidebar").trigger("click"),
    $(".list-chapter .view-more").click(function () {
        return $(".list-chapter ul").addClass("active"), $(this).remove(), !1;
    }),
    $(".dropdown-genres").length &&
        $(".dropdown-genres").insertAfter($(".comic-filter h1")),
    $(".advsearch-page .genre-item").click(function () {
        var e = $(this).find("span");
        e.hasClass("icon-checkbox")
            ? e.removeClass("icon-checkbox").addClass("icon-tick")
            : e.hasClass("icon-tick")
            ? e.removeClass("icon-tick").addClass("icon-cross")
            : e.removeClass("icon-cross").addClass("icon-checkbox");
    }),
    $(".advsearch-page .btn-collapse").click(function () {
        $(this).find(".show-text").toggleClass("hidden"),
            $(this).find(".hide-text").toggleClass("hidden"),
            $(this)
                .find(".fa")
                .toggleClass("fa-angle-double-down")
                .toggleClass("fa-angle-double-up"),
            $(".advsearch-form").toggleClass("hidden");
    }),
    $(".advsearch-page .btn-search").click(function () {
        var e = $(".btn-reset").attr("href"),
            o = "",
            a = "",
            n = "",
            r = "";
        $.each($(".genre-item span"), function (e, s) {
            $(s).hasClass("icon-tick")
                ? ((o += n + $(s).attr("data-id")), (n = ","))
                : $(s).hasClass("icon-cross") &&
                  ((a += r + $(s).attr("data-id")), (r = ","));
        }),
            (location.href =
                e +
                "?genres=" +
                o +
                "&notgenres=" +
                a +
                "&gender=" +
                $(".select-gender").val() +
                "&status=" +
                $(".select-status").val() +
                "&minchapter=" +
                $(".select-minchapter").val() +
                "&sort=" +
                $(".select-sort").val());
    }),
    $(".chapter a").length &&
        "undefined" != typeof Storage &&
        void 0 !== localStorage["visited-comics"])
) {
    var I = JSON.parse(localStorage["visited-comics"]);
    if ($(".list-chapter .chapter a").length) {
        var F = I.map(function (e) {
            return e.id;
        }).indexOf(gOpts.comicId);
        if (F > -1 && I[F].chapterIds)
            for (
                var A = I[F].chapterIds, H = 0;
                H < $(".list-chapter .chapter a").length && !(H >= 25);
                H++
            ) {
                var R = $(".list-chapter .chapter a").eq(H),
                    L = R.attr("data-id");
                L && $.inArray(parseInt(L), A) > -1 && R.addClass("visited");
            }
    }
    $(".comic-item .chapter a").length &&
        $(".comic-item").each(function (e, o) {
            var a = $(this).attr("data-id");
            if (a) {
                var n = I.map(function (e) {
                    return e.id;
                }).indexOf(parseInt(a));
                if (n > -1 && I[n].chapterIds) {
                    var r = I[n].chapterIds;
                    r &&
                        r.length > 0 &&
                        $(this)
                            .find(".chapter a")
                            .each(function (e, o) {
                                var a = $(this).attr("data-id");
                                a &&
                                    $.inArray(parseInt(a), r) > -1 &&
                                    $(this).addClass("visited");
                            });
                }
            }
        });
}
var visitedComicsLimit = 360;
function saveVisitedComics() {
    if ($("body").hasClass("chapter-detail") && "undefined" != typeof Storage) {
        var e = gOpts.chapterId;
        if (e) {
            void 0 !== localStorage["visited-chapters"] &&
                localStorage.removeItem("visited-chapters");
            var o = $(".breadcrumb li").eq(2).find("a"),
                a = $(".breadcrumb li").eq(3).find("a"),
                n = $('meta[itemprop="image"]').attr("content"),
                r =
                    gOpts.siteRoot.indexOf("//www.") > -1
                        ? gOpts.siteRoot.replace("//www.", "//www.")
                        : gOpts.siteRoot.replace("//", "//");
            if (o && a && n) {
                var s = gOpts.comicId,
                    l = {
                        id: s,
                        image: n.replace(r, ""),
                        name: o.find("span").text(),
                        url: o.attr("href").replace(gOpts.siteRoot, ""),
                        chapterName: a
                            .find("span")
                            .text()
                            .replace("Chapter ", ""),
                        chapterUrl: a.attr("href").replace(gOpts.siteRoot, ""),
                        chapterIds: [e],
                    };
                if (void 0 !== localStorage["visited-comics"]) {
                    var c = JSON.parse(localStorage["visited-comics"]),
                        d = c
                            .map(function (e) {
                                return e.id;
                            })
                            .indexOf(s);
                    if (d > -1) {
                        var p = c[d],
                            u =
                                p.chapterIds && p.chapterIds.length > 0
                                    ? p.chapterIds
                                    : [];
                        if (u.length > 0) {
                            var h = u.indexOf(e);
                            h >= 0 && u.splice(h, 1);
                        }
                        if ((u.push(e), u.length > 20))
                            for (var f = 20; f < u.length; f++) u.shift();
                        (l.chapterIds = u), c.splice(d, 1);
                    }
                    if ((c.push(l), c.length > visitedComicsLimit))
                        for (f = visitedComicsLimit; f < c.length; f++)
                            c.shift();
                    localStorage["visited-comics"] = JSON.stringify(c);
                } else {
                    var m = [];
                    m.push(l),
                        (localStorage["visited-comics"] = JSON.stringify(m));
                }
            }
        }
    }
}
if (
    $("body").hasClass("comic-detail") &&
    !$(".read-continue").length &&
    "undefined" != typeof Storage &&
    void 0 !== localStorage["visited-comics"] &&
    (I = JSON.parse(localStorage["visited-comics"])).length > 0
) {
    for (var i = I.length - 1; i >= 0; i--)
        if (I[i].id == gOpts.comicId) {
            var j = $("<a>")
                .html('続ける <i class="fa fa-angle-right"></i>')
                .attr("class", "read-continue btn btn-danger mrb5")
                .attr("href", I[i].chapterUrl);
            (j = "\n" + j[0].outerHTML), $(".read-action").append(j);
            break;
        }
}
if ($(".visited-comics-page").length) {
    if (3 == getParameterByName("t")) populateVisitedComicCloud();
    else if ("undefined" != typeof Storage) {
        if (void 0 !== localStorage["visited-comics"]) {
            var O = $(".visited-actions").empty().addClass("mrb5 text-center"),
                E = 36;
            (I = JSON.parse(localStorage["visited-comics"])).length > 0
                ? ($(".visited-comics-page").data("items", I.reverse()),
                  populateVisitedComic(1, E),
                  createPaging(I, E))
                : $(".visited-comics-page").html(
                      "まだ読んだ記事はありません。"
                  );
        } else $(".visited-comics-page").html("まだ読んだ記事はありません。");
    }
}
function populateVisitedComicCloud() {
    if (
        ($(".visited-tab .comment-nav li").eq(0).removeClass("active"),
        $(".visited-tab .comment-nav li").eq(1).addClass("active"),
        0 == AjaxHelper.loadWaiting)
    ) {
        AjaxHelper.setLoadWaiting(!0);
        var e = getParameterByName("page");
        null == e && (e = 1),
            $.ajax({
                type: "GET",
                url:
                    siteRoot +
                    "/Comic/Services/ComicService.asmx/GetReadComics",
                xhrFields: { withCredentials: !0 },
                data: {
                    token: gOpts.readToken ? gOpts.readToken : "",
                    page: e,
                },
                success: function (e) {
                    if (e.success) {
                        var o = $(".visited-comics-page");
                        e.listHtml &&
                            (o.html(e.listHtml),
                            initLazyload(),
                            e.pagerHtml &&
                                $('<div class="pagination-outter"></div>')
                                    .html(e.pagerHtml)
                                    .appendTo(o),
                            $("html, body").animate(
                                { scrollTop: 0 },
                                0,
                                "linear"
                            ));
                    }
                },
                complete: function (e) {
                    AjaxHelper.setLoadWaiting(!1);
                },
                error: function (e, o, a) {},
            });
    }
}
function createPaging(e, o) {
    var a = Math.ceil(e.length / o);
    if (a > 1) {
        for (
            var n = $("<div>").addClass("pagination-outter"),
                r = $("<ul>").addClass("pagination visited-pagination"),
                s = 1;
            s <= a;
            s++
        ) {
            var l = $("<li>");
            1 == s && l.addClass("active");
            var c = $("<a>")
                .text(s)
                .data("page", s)
                .click(function (e) {
                    return (
                        e.preventDefault(),
                        $(".visited-pagination li").removeClass("active"),
                        $(this).parent().addClass("active"),
                        populateVisitedComic($(this).data("page"), o),
                        $("html, body").animate(
                            { scrollTop: 0 },
                            200,
                            "linear"
                        ),
                        !1
                    );
                });
            l.append(c), r.append(l);
        }
        n.append(r),
            $(".visited-comics-page .pagination-outter").remove(),
            $(".visited-comics-page").append(n);
    }
}
function populateVisitedComic(e, o) {
    var a = $(".visited-comics-page").data("items");
    if (a) {
        for (
            var n = a.slice((e - 1) * o, e * o),
                r = $("<div>").addClass("row").addClass("visited-list"),
                s = "//st." + gOpts.host,
                l = 0;
            l < n.length;
            l++
        ) {
            var c = n[l],
                d = $("<div>").addClass("item"),
                p = $("<figure>").addClass("clearfix"),
                u = $("<div>").addClass("image"),
                h = $("<a>").attr("title", c.name).attr("href", c.url),
                f =
                    ($("<img>")
                        .addClass("lazy center")
                        .attr("alt", c.name)
                        .attr(
                            "data-original",
                            0 != c.image.indexOf("/data/")
                                ? c.image
                                : s + c.image
                        )
                        .attr(
                            "src",
                            "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
                        )
                        .data("id", c.id)
                        .on("error", function (e) {
                            validateComic(this);
                        })
                        .appendTo(h),
                    $("<div>").addClass("view"));
            $("<a>")
                .addClass("visited-remove")
                .attr("href", "#")
                .data("id", c.id)
                .html('<i class="fa fa-times"></i> Delete')
                .click(function (e) {
                    return e.preventDefault(), removeVisitedComic($(this)), !1;
                })
                .appendTo(f),
                u.append(h).append(f);
            var m = $("<figcaption>"),
                g = $("<h3>"),
                v = $("<ul>"),
                x = $("<li>").addClass("chapter clearfix"),
                b = $("<a>")
                    .html(
                        "続ける" +
                            c.chapterName +
                            ' <i class="fa fa-angle-right"></i>'
                    )
                    .attr("href", c.chapterUrl),
                C = $("<a>")
                    .html(c.name)
                    .attr("title", c.name)
                    .attr("href", c.url);
            g.append(C),
                x.append(b),
                v.append(x),
                m.append(g).append(v),
                p.append(u).append(m),
                d.append(p),
                r.append(d);
        }
        $(".visited-comics-page .pagination").length
            ? ($(".visited-comics-page .visited-list").remove().append(r),
              $(".visited-comics-page").prepend(r))
            : $(".visited-comics-page").empty().append(r),
            initLazyload();
    }
}
if (
    $(".visited-comics").length &&
    "undefined" != typeof Storage &&
    void 0 !== localStorage["visited-comics"] &&
    (I = JSON.parse(localStorage["visited-comics"])).length > 0
) {
    O = $("<div>")
        .addClass("box darkBox")
        .html(
            '<h2>ストーリー読了履歴<a class="view-all" href="/history">すべてを見る</a></h2>'
        );
    var U = $("<ul>").addClass("list-unstyled"),
        M = ((m = 0), "//st." + gOpts.host);
    for (i = I.length - 1; i >= 0; i--) {
        var D = I[i],
            P = $("<li>").addClass("clearfix"),
            N = $("<div>").addClass("t-item");
        P.append(N);
        var W = $("<a>")
            .addClass("thumb")
            .attr("title", D.name)
            .attr("href", D.chapterUrl);
        $("<img>")
            .attr("class", "center")
            .attr("alt", D.name)
            .attr("src", 0 != D.image.indexOf("/data/") ? D.image : M + D.image)
            .data("id", D.id)
            .on("error", function (e) {
                validateComic(this);
            })
            .appendTo(W),
            N.append(W);
        var G = $("<h3>").addClass("title"),
            B = $("<a>").html(D.name).attr("href", D.chapterUrl);
        G.append(B), N.append(G);
        var z = $("<p>").addClass("chapter"),
            V = $("<a>")
                .html(
                    "続ける" +
                        D.chapterName +
                        ' <i class="fa fa-angle-right"></i>'
                )
                .attr("href", D.chapterUrl),
            q = $("<span>").addClass("view pull-right"),
            K = $("<a>")
                .addClass("visited-remove")
                .attr("href", "#")
                .data("id", D.id)
                .html('<i class="fa fa-times"></i> Delete')
                .click(function (e) {
                    return e.preventDefault(), removeVisitedComic($(this)), !1;
                })
                .appendTo(q);
        if ((z.append(V).append(q), N.append(z), U.append(P), ++m > 2)) break;
    }
    O.append(U), $(".visited-comics").append(O);
}
function validateComic(e) {
    var o = parseInt($(e).data("id"));
    $.ajax({
        type: "GET",
        url: "/Comic/Services/ComicService.asmx/ValidateComic",
        data: { comicId: o },
        success: function (a) {
            if (
                "undefined" != typeof Storage &&
                void 0 !== localStorage["visited-comics"]
            ) {
                var n = JSON.parse(localStorage["visited-comics"]),
                    r = n
                        .map(function (e) {
                            return e.id;
                        })
                        .indexOf(o);
                if (r > -1) {
                    if (a.success) {
                        (n[r].image = a.image),
                            (n[r].name = a.name),
                            (n[r].url = a.url);
                        var s = "//" + gOpts.host;
                        $(e).attr(
                            "src",
                            0 != a.image.indexOf("/data/")
                                ? a.image
                                : s + a.image
                        );
                    } else
                        n.splice(r, 1),
                            $(".visited-comics-page").length
                                ? $(e).parents(".item").remove()
                                : $(".visited-comics").length &&
                                  $(e).parents("li").remove();
                    localStorage["visited-comics"] = JSON.stringify(n);
                }
            }
        },
    }),
        $(e).off("error");
}
function removeVisitedComic(e) {
    if (
        "undefined" != typeof Storage &&
        void 0 !== localStorage["visited-comics"]
    ) {
        var o = JSON.parse(localStorage["visited-comics"]),
            a = $(e).data("id");
        if (o.length > 0) {
            var n = o
                .map(function (e) {
                    return e.id;
                })
                .indexOf(a);
            n > -1 &&
                (o.splice(n, 1),
                (localStorage["visited-comics"] = JSON.stringify(o)),
                $(e).parents(".item").remove(),
                $(e).parents("li").remove());
        }
    }
}
function getParameterByName(e, o) {
    o || (o = window.location.href);
    var a = RegExp(
        "[?&]" + (e = e.replace(/[\[\]]/g, "\\$&")) + "(=([^&#]*)|&|#|$)"
    ).exec(o);
    return a
        ? a[2]
            ? decodeURIComponent(a[2].replace(/\+/g, " "))
            : ""
        : null;
}
function setupLazyLoad(e) {
    var o = [],
        a = document.querySelectorAll(e);
    if (
        ([].forEach.call(a, function (e, a) {
            o.push(e);
        }),
        o.length > 0)
    ) {
        var n = !1,
            r = !1,
            s = !1,
            l = !1;
        if ("IntersectionObserver" in window) {
            var c = new IntersectionObserver(
                function (e, o) {
                    e.forEach(function (e) {
                        e.intersectionRatio > 0 &&
                            (d(e.target), o.unobserve(e.target));
                    });
                },
                { rootMargin: "200px 0px 200px 0px", threshold: 0 }
            );
            o.forEach(function (e) {
                c.observe(e);
            });
        } else
            o.forEach(function (e) {
                d(e);
            });
        function d(o) {
            if (null != o) {
                var a = o.getAttribute("data-type");
                if (".comics-followed-block" == e) {
                    if (0 == r) {
                        r = !0;
                        var c = getUserGuid();
                        null != c &&
                            $.ajax({
                                type: "GET",
                                url:
                                    siteRoot +
                                    "/Comic/Services/ComicService.asmx/GetFollowedBlockComics",
                                data: {
                                    userGuid: c,
                                    token: gOpts.token ? gOpts.token : "",
                                },
                                success: function (e) {
                                    e.success &&
                                        e.followedListHtml &&
                                        ($(".comics-followed-block").html(
                                            replaceUrl(e.followedListHtml)
                                        ),
                                        initLazyload());
                                },
                            });
                    }
                } else if ("end-chapter" == a) {
                    if (0 == s) {
                        s = !0;
                        var d = "";
                        1 == followedOnChapter &&
                            gOpts.token &&
                            (d = gOpts.token),
                            $.ajax({
                                type: "POST",
                                url:
                                    siteRoot +
                                    "/Comic/Services/ComicService.asmx/ChapterLoaded",
                                xhrFields: { withCredentials: !0 },
                                data: {
                                    chapterId: gOpts.chapterId,
                                    comicToken: gOpts.key,
                                    userToken: d,
                                },
                                success: function (e) {
                                    e.success &&
                                        e.token &&
                                        $.ajax({
                                            type: "POST",
                                            url:
                                                siteRoot +
                                                "/Comic/Services/ComicService.asmx/Read",
                                            xhrFields: { withCredentials: !0 },
                                            data: {
                                                chapterId: gOpts.chapterId,
                                                token: e.token,
                                            },
                                            success: function (e) {
                                                e.success &&
                                                    e.readToken &&
                                                    UpdateUserReadToken(
                                                        e.readToken
                                                    );
                                            },
                                        });
                                },
                            });
                    }
                } else
                    "top-members" == a
                        ? 0 == l && (l = !0)
                        : "facebook" == a &&
                          0 == n &&
                          ($("body").hasClass("comic-detail")
                              ? addEventListener("scroll", p, !1)
                              : ((n = !0), u()));
            }
        }
        function p() {
            (n = !0), u(), removeEventListener("scroll", p);
        }
        function u() {
            var e, o, a, n, r;
            (window.fbAsyncInit = function () {
                FB.init({
                    appId: "745819368841087",
                    status: !1,
                    cookie: !0,
                    version: "v2.0",
                    xfbml: !0,
                    oauth: !0,
                });
            }),
                (o = "script"),
                (a = "facebook-jssdk"),
                (r = (e = document).getElementsByTagName(o)[0]),
                e.getElementById(a) ||
                    (((n = e.createElement(o)).id = a),
                    (n.src =
                        "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=745819368841087&version=v2.7"),
                    r.parentNode.insertBefore(n, r));
        }
    }
}
function reCrawler() {
    ajaxComicPost("ReCrawlerChapter", refreshCallback, {
        chapterId: gOpts.chapterId,
    });
}
function fixChapter() {
    ajaxComicPost("FixChapter", refreshCallback, {
        chapterId: gOpts.chapterId,
    });
}
function deleteChapterPage(e) {
    ajaxComicPost("DeleteChapterPage", deleteChapterPageCallback, {
        chapterId: gOpts.chapterId,
        index: $(e).parent().index(".page-chapter"),
    });
}
function deleteChapterPageCallback(e) {
    $(".page-chapter")
        .eq(e.index)
        .slideUp(function () {
            $(this).remove();
        });
}
function refreshCallback(e) {
    1 == e.success && location.reload();
}
function ajaxComicPost(e, o, a) {
    0 == AjaxHelper.loadWaiting &&
        (AjaxHelper.setLoadWaiting(!0),
        $.ajax({
            type: "POST",
            url: "/Comic/Services/ComicService.asmx/" + e,
            data: a,
            success: function (e) {
                void 0 !== o && o(e);
            },
            complete: function (e) {
                AjaxHelper.setLoadWaiting(!1);
            },
            error: function (e, o, a) {
                AjaxHelper.processAjaxError(a);
            },
        }));
}
setupLazyLoad(".lazy-module"), saveVisitedComics();
